(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _ = require('lodash');

module.exports = {
  addObserver: addObserver,
  removeObserver: removeObserver,
  start: start,
  stop: stop,
  toggle: toggle
};

var observers = [];
var animate = window.requestAnimationFrame;

var isRunning = false;
var previous = undefined;

function addObserver(fn) {
  observers.push(fn);
  return fn;
}

function notifyObservers(duration) {
  _.forEach(observers, function (o) {
    return o(duration);
  });
}

function removeObserver(fn) {
  _.without(observers, fn);
}

function start() {
  if (isRunning) return;
  isRunning = true;
  previous = null;
  animate(tick);
}

function stop() {
  isRunning = false;
  previous = null;
}

function tick(end) {
  if (previous === null) {
    previous = end;
  }
  var duration = (end - previous) / (1000 / 60);
  previous = end;
  notifyObservers(duration);
  if (isRunning) animate(tick);
}

function toggle() {
  if (isRunning) stop();else start();
}

},{"lodash":"lodash"}],2:[function(require,module,exports){
'use strict';

var _ = require('lodash'),
    randomcolor = require('randomcolor');

module.exports = function buildPlanet(width, height) {

  var color = randomcolor();
  var size = _.random(5, 20, true);
  var speedX = _.random(-5, 5);
  var speedY = _.random(-5, 5);
  var prevSpeedX = speedX;
  var prevSpeedY = speedY;

  var newPlanet = {
    get color() {
      return color;
    },
    get mass() {
      return size * size * size;
    },
    get prevSpeedX() {
      return prevSpeedX;
    },
    get prevSpeedY() {
      return prevSpeedY;
    },
    get size() {
      return size;
    },
    get speedX() {
      return speedX;
    },
    set speedX(newSpeed) {
      prevSpeedX = speedX;
      speedX = newSpeed;
    },
    get speedY() {
      return speedY;
    },
    set speedY(newSpeed) {
      prevSpeedY = speedY;
      speedY = newSpeed;
    },

    x: _.random(width),
    y: _.random(height)
  };

  return newPlanet;
};

},{"lodash":"lodash","randomcolor":"randomcolor"}],3:[function(require,module,exports){
'use strict';

var _ = require('lodash');

var frictionConstant = undefined;
module.exports = function calculateFrictionOnCicrcles(circles, _frictionConstant_) {
  frictionConstant = _frictionConstant_;
  _.forEach(circles, calculateFrictionOnCicrcle);
};

function calculateFrictionOnCicrcle(circle) {
  var frictionX = frictionConstant * circle.speedX;
  var frictionY = frictionConstant * circle.speedY;
  var accX = frictionX / circle.mass;
  var accY = frictionY / circle.mass;

  var newXSpeed = circle.speedX - accX;
  circle.speedX = newXSpeed;

  var newYSpeed = circle.speedY - accY;
  circle.speedY = newYSpeed;
}

},{"lodash":"lodash"}],4:[function(require,module,exports){
'use strict';

var _ = require('lodash');

var gravityConstant = undefined;
module.exports = function calculateSpeedForGravityOnCircles(circles, _gravityConstant_) {
  gravityConstant = _gravityConstant_;
  _.forEach(circles, function (c) {
    return calculateSpeedForGravityOnCircle(c, circles);
  });
};

function calculateSpeedForGravityOnCircle(circle, circles) {
  var circleA = circle;
  _.forEach(circles, function (circleB) {
    return calcGravityBetweenAAndB(circleA, circleB);
  });
}

function calcGravityBetweenAAndB(circleA, circleB) {
  if (circleA === circleB) return;

  var xDistance = circleA.x - circleB.x;
  var yDistance = circleA.y - circleB.y;
  var distance = Math.sqrt(Math.pow(xDistance, 2) + Math.pow(yDistance, 2));

  if (distance < circleA.size + circleB.size) {
    return;
  }

  var direction = {
    x: xDistance / distance,
    y: yDistance / distance
  };
  var gravityForce = gravityConstant * (circleA.mass * circleB.mass) / Math.pow(distance, 2);
  var xAccA = gravityForce * direction.x / circleA.mass;
  var yAccA = gravityForce * direction.y / circleB.mass;
  circleA.speedX -= xAccA;
  circleA.speedY -= yAccA;
}

},{"lodash":"lodash"}],5:[function(require,module,exports){
'use strict';

var _ = require('lodash'),
    windowDimension = require('./windowDimensionObservable');

module.exports = function calculateNewPositionForCircles(circles, frameDelta) {
  _.forEach(circles, function (c) {
    return calculateNewPositionForCircle(c, frameDelta);
  });
};

function calculateNewPositionForCircle(circle, frameDelta) {
  var deltaX = (circle.speedX + circle.prevSpeedX) / 2;
  var deltaY = (circle.speedY + circle.prevSpeedY) / 2;
  circle.x = circle.x + deltaX * frameDelta;
  circle.y = circle.y + deltaY * frameDelta;

  repositionIfOutsideOfCanvas(circle);
}

function repositionIfOutsideOfCanvas(circle) {
  if (circle.x > windowDimension.width + 45) circle.x = -40;
  if (circle.x < -45) circle.x = windowDimension.width + 40;

  if (circle.y > windowDimension.height + 45) circle.y = -40;
  if (circle.y < -45) circle.y = windowDimension.height + 40;
}

},{"./windowDimensionObservable":8,"lodash":"lodash"}],6:[function(require,module,exports){
'use strict';

var windowDimension = require('./windowDimensionObservable');

module.exports = {
  get context() {
    return context;
  },
  clear: clear,
  init: init,
  renderCircles: renderCircles
};

var canvas = document.createElement('canvas'),
    context = canvas.getContext("2d");

windowDimension.addObserver(updateCanvasDimensions);

function clear() {
  context.clearRect(0, 0, canvas.width, canvas.height);
}

function init(parentNode) {
  updateCanvasDimensions();
  parentNode.appendChild(canvas);
}

function renderCircles(circles) {
  _.forEach(circles, renderCircle);
}

function renderCircle(circle) {
  context.beginPath();
  context.arc(circle.x, circle.y, circle.size, 0, 2 * Math.PI);
  context.fillStyle = circle.color;
  context.fill();
}

function updateCanvasDimensions() {
  canvas.width = windowDimension.width;
  canvas.height = windowDimension.height;
}

},{"./windowDimensionObservable":8}],7:[function(require,module,exports){
'use strict';

var _ = require('lodash'),
    animation = require('./animationObservable'),
    calculateFriction = require('./calculateFriction'),
    calculateGravity = require('./calculateGravity'),
    calculateNewPosition = require('./calculateNewPosition'),
    canvas = require('./canvas'),
    buildPlanet = require('./buildPlanet'),
    windowDimension = require('./windowDimensionObservable');

var animateCheckbox = document.getElementById('animate-checkbox'),
    frictionConstInput = document.getElementById('friction-constant'),
    gravityConstInput = document.getElementById('gravity-constant'),
    planetCountInput = document.getElementById('planet-count-input'),
    resetButton = document.getElementById('reset-button');

var planets = [];
var planetCount = undefined,
    isAnimating = undefined,
    frictionConst = undefined,
    gravityConst = undefined;

animateCheckbox.addEventListener('change', updateSettings);
frictionConstInput.addEventListener('keydown', function (e) {
  if (frictionConstInput.value === '') return;
  if (e.keyCode === 38) frictionConst += 0.5;
  if (e.keyCode === 40) frictionConst -= 0.5;
  if (e.keyCode === 38 || e.keyCode === 40) {
    frictionConstInput.value = parseFloat(frictionConst);
    e.preventDefault();
  }
  updateSettings();
});
gravityConstInput.addEventListener('keydown', function (e) {
  if (gravityConstInput.value === '') return;
  if (e.keyCode === 38) gravityConst += 0.5;
  if (e.keyCode === 40) gravityConst -= 0.5;
  if (e.keyCode === 38 || e.keyCode === 40) {
    gravityConstInput.value = parseFloat(gravityConst);
    e.preventDefault();
  }
  updateSettings();
});
planetCountInput.addEventListener('keydown', function (e) {
  if (planetCountInput.value === '') return;
  if (e.keyCode === 38) planetCount += 1;
  if (e.keyCode === 40) planetCount -= 1;
  if (e.keyCode === 38 || e.keyCode === 40) {
    planetCountInput.value = parseFloat(planetCount);
    e.preventDefault();
  }
  resetSettings();
});
resetButton.addEventListener('click', resetSettings);

canvas.init(document.body);
animation.addObserver(onTick);
resetSettings();

function onTick(frameDelta) {
  calculateGravity(planets, gravityConst);
  calculateFriction(planets, frictionConst);
  calculateNewPosition(planets, frameDelta);
  canvas.clear();
  canvas.renderCircles(planets);
}

function updateSettings() {
  updateAnimation();
  updateFriction();
  updateGravity();
}

function resetSettings() {
  updateCount();
  updateSettings();
}

function updateCount() {
  planetCount = parseFloat(planetCountInput.value);
  planets = [];
  for (var i = 0; i < planetCount; i++) {
    planets.push(buildPlanet(windowDimension.width, windowDimension.height));
  }
}

function updateAnimation() {
  var isChecked = animateCheckbox.checked;
  if (isChecked) animation.start();else animation.stop();
}

function updateFriction() {
  frictionConst = parseFloat(frictionConstInput.value);
}

function updateGravity() {
  gravityConst = parseFloat(gravityConstInput.value);
}

},{"./animationObservable":1,"./buildPlanet":2,"./calculateFriction":3,"./calculateGravity":4,"./calculateNewPosition":5,"./canvas":6,"./windowDimensionObservable":8,"lodash":"lodash"}],8:[function(require,module,exports){
'use strict';

var _ = require('lodash');

module.exports = {
  get height() {
    return height;
  },
  get width() {
    return width;
  },
  addObserver: addObserver,
  removeObserver: removeObserver
};

var observers = [];

var height = undefined,
    width = undefined;
updateDimensions();
attachHandler();

function attachHandler() {
  window.addEventListener('resize', _.debounce(handleResize, 200));
}

function addObserver(fn) {
  observers.push(fn);
  return fn;
}

function removeObserver(fn) {
  _.without(observers, fn);
}

function notifyObservers() {
  _.forEach(observers, function (o) {
    return o();
  });
}

function handleResize(e) {
  updateDimensions();
  notifyObservers();
}

function updateDimensions() {
  height = window.innerHeight;
  width = window.innerWidth;
}

},{"lodash":"lodash"}]},{},[7])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGFuaW1hdGlvbk9ic2VydmFibGUuanMiLCJzcmNcXGJ1aWxkUGxhbmV0LmpzIiwic3JjXFxjYWxjdWxhdGVGcmljdGlvbi5qcyIsInNyY1xcY2FsY3VsYXRlR3Jhdml0eS5qcyIsInNyY1xcY2FsY3VsYXRlTmV3UG9zaXRpb24uanMiLCJzcmNcXGNhbnZhcy5qcyIsInNyY1xcbWFpbi5qcyIsInNyY1xcd2luZG93RGltZW5zaW9uT2JzZXJ2YWJsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBTSxJQUFJLFFBQVEsUUFBUixDQUFKOztBQUVOLE9BQU8sT0FBUCxHQUFpQjtBQUNmLDBCQURlO0FBRWYsZ0NBRmU7QUFHZixjQUhlO0FBSWYsWUFKZTtBQUtmLGdCQUxlO0NBQWpCOztBQVFBLElBQU0sWUFBWSxFQUFaO0FBQ04sSUFBTSxVQUFVLE9BQU8scUJBQVA7O0FBRWhCLElBQUksWUFBWSxLQUFaO0FBQ0osSUFBSSxvQkFBSjs7QUFFQSxTQUFTLFdBQVQsQ0FBcUIsRUFBckIsRUFBeUI7QUFDdkIsWUFBVSxJQUFWLENBQWUsRUFBZixFQUR1QjtBQUV2QixTQUFPLEVBQVAsQ0FGdUI7Q0FBekI7O0FBS0EsU0FBUyxlQUFULENBQXlCLFFBQXpCLEVBQW1DO0FBQ2pDLElBQUUsT0FBRixDQUFVLFNBQVYsRUFBcUI7V0FBSyxFQUFFLFFBQUY7R0FBTCxDQUFyQixDQURpQztDQUFuQzs7QUFJQSxTQUFTLGNBQVQsQ0FBd0IsRUFBeEIsRUFBNEI7QUFDMUIsSUFBRSxPQUFGLENBQVUsU0FBVixFQUFxQixFQUFyQixFQUQwQjtDQUE1Qjs7QUFJQSxTQUFTLEtBQVQsR0FBaUI7QUFDZixNQUFHLFNBQUgsRUFBYyxPQUFkO0FBQ0EsY0FBWSxJQUFaLENBRmU7QUFHZixhQUFXLElBQVgsQ0FIZTtBQUlmLFVBQVEsSUFBUixFQUplO0NBQWpCOztBQU9BLFNBQVMsSUFBVCxHQUFnQjtBQUNkLGNBQVksS0FBWixDQURjO0FBRWQsYUFBVyxJQUFYLENBRmM7Q0FBaEI7O0FBS0EsU0FBUyxJQUFULENBQWMsR0FBZCxFQUFtQjtBQUNqQixNQUFHLGFBQWEsSUFBYixFQUFtQjtBQUNwQixlQUFXLEdBQVgsQ0FEb0I7R0FBdEI7QUFHQSxNQUFJLFdBQVcsQ0FBQyxNQUFNLFFBQU4sQ0FBRCxJQUFvQixPQUFPLEVBQVAsQ0FBcEIsQ0FKRTtBQUtqQixhQUFXLEdBQVgsQ0FMaUI7QUFNakIsa0JBQWdCLFFBQWhCLEVBTmlCO0FBT2pCLE1BQUcsU0FBSCxFQUFjLFFBQVEsSUFBUixFQUFkO0NBUEY7O0FBVUEsU0FBUyxNQUFULEdBQWtCO0FBQ2hCLE1BQUcsU0FBSCxFQUFjLE9BQWQsS0FDSyxRQURMO0NBREY7Ozs7O0FDbkRBLElBQU0sSUFBSSxRQUFRLFFBQVIsQ0FBSjtJQUNBLGNBQWMsUUFBUSxhQUFSLENBQWQ7O0FBRU4sT0FBTyxPQUFQLEdBQWlCLFNBQVMsV0FBVCxDQUFxQixLQUFyQixFQUE0QixNQUE1QixFQUFvQzs7QUFFbkQsTUFBSSxRQUFRLGFBQVIsQ0FGK0M7QUFHbkQsTUFBSSxPQUFPLEVBQUUsTUFBRixDQUFTLENBQVQsRUFBWSxFQUFaLEVBQWdCLElBQWhCLENBQVAsQ0FIK0M7QUFJbkQsTUFBSSxTQUFTLEVBQUUsTUFBRixDQUFTLENBQUMsQ0FBRCxFQUFJLENBQWIsQ0FBVCxDQUorQztBQUtuRCxNQUFJLFNBQVMsRUFBRSxNQUFGLENBQVMsQ0FBQyxDQUFELEVBQUksQ0FBYixDQUFULENBTCtDO0FBTW5ELE1BQUksYUFBYSxNQUFiLENBTitDO0FBT25ELE1BQUksYUFBYSxNQUFiLENBUCtDOztBQVNuRCxNQUFJLFlBQVk7QUFDZCxRQUFJLEtBQUosR0FBWTtBQUFFLGFBQU8sS0FBUCxDQUFGO0tBQVo7QUFDQSxRQUFJLElBQUosR0FBVztBQUFFLGFBQU8sT0FBTyxJQUFQLEdBQWMsSUFBZCxDQUFUO0tBQVg7QUFDQSxRQUFJLFVBQUosR0FBaUI7QUFBRSxhQUFPLFVBQVAsQ0FBRjtLQUFqQjtBQUNBLFFBQUksVUFBSixHQUFpQjtBQUFFLGFBQU8sVUFBUCxDQUFGO0tBQWpCO0FBQ0EsUUFBSSxJQUFKLEdBQVc7QUFBRSxhQUFPLElBQVAsQ0FBRjtLQUFYO0FBQ0EsUUFBSSxNQUFKLEdBQWE7QUFBRSxhQUFPLE1BQVAsQ0FBRjtLQUFiO0FBQ0EsUUFBSSxNQUFKLENBQVcsUUFBWCxFQUFxQjtBQUNuQixtQkFBYSxNQUFiLENBRG1CO0FBRW5CLGVBQVMsUUFBVCxDQUZtQjtLQUFyQjtBQUlBLFFBQUksTUFBSixHQUFhO0FBQUUsYUFBTyxNQUFQLENBQUY7S0FBYjtBQUNBLFFBQUksTUFBSixDQUFXLFFBQVgsRUFBcUI7QUFDbkIsbUJBQWEsTUFBYixDQURtQjtBQUVuQixlQUFTLFFBQVQsQ0FGbUI7S0FBckI7O0FBS0EsT0FBRyxFQUFFLE1BQUYsQ0FBUyxLQUFULENBQUg7QUFDQSxPQUFHLEVBQUUsTUFBRixDQUFTLE1BQVQsQ0FBSDtHQWxCRSxDQVQrQzs7QUE4Qm5ELFNBQU8sU0FBUCxDQTlCbUQ7Q0FBcEM7Ozs7O0FDSGpCLElBQU0sSUFBSSxRQUFRLFFBQVIsQ0FBSjs7QUFFTixJQUFJLDRCQUFKO0FBQ0EsT0FBTyxPQUFQLEdBQWlCLFNBQVMsMkJBQVQsQ0FBcUMsT0FBckMsRUFBOEMsa0JBQTlDLEVBQWtFO0FBQ2pGLHFCQUFtQixrQkFBbkIsQ0FEaUY7QUFFakYsSUFBRSxPQUFGLENBQVUsT0FBVixFQUFtQiwwQkFBbkIsRUFGaUY7Q0FBbEU7O0FBS2pCLFNBQVMsMEJBQVQsQ0FBb0MsTUFBcEMsRUFBNEM7QUFDMUMsTUFBSSxZQUFZLG1CQUFtQixPQUFPLE1BQVAsQ0FETztBQUUxQyxNQUFJLFlBQVksbUJBQW1CLE9BQU8sTUFBUCxDQUZPO0FBRzFDLE1BQUksT0FBTyxZQUFZLE9BQU8sSUFBUCxDQUhtQjtBQUkxQyxNQUFJLE9BQU8sWUFBWSxPQUFPLElBQVAsQ0FKbUI7O0FBTTFDLE1BQUksWUFBWSxPQUFPLE1BQVAsR0FBZ0IsSUFBaEIsQ0FOMEI7QUFPMUMsU0FBTyxNQUFQLEdBQWdCLFNBQWhCLENBUDBDOztBQVMxQyxNQUFJLFlBQVksT0FBTyxNQUFQLEdBQWdCLElBQWhCLENBVDBCO0FBVTFDLFNBQU8sTUFBUCxHQUFnQixTQUFoQixDQVYwQztDQUE1Qzs7Ozs7QUNSQSxJQUFNLElBQUksUUFBUSxRQUFSLENBQUo7O0FBRU4sSUFBSSwyQkFBSjtBQUNBLE9BQU8sT0FBUCxHQUFpQixTQUFTLGlDQUFULENBQTJDLE9BQTNDLEVBQW9ELGlCQUFwRCxFQUF1RTtBQUN0RixvQkFBa0IsaUJBQWxCLENBRHNGO0FBRXRGLElBQUUsT0FBRixDQUFVLE9BQVYsRUFBbUI7V0FBSyxpQ0FBaUMsQ0FBakMsRUFBb0MsT0FBcEM7R0FBTCxDQUFuQixDQUZzRjtDQUF2RTs7QUFLakIsU0FBUyxnQ0FBVCxDQUEwQyxNQUExQyxFQUFrRCxPQUFsRCxFQUEyRDtBQUN6RCxNQUFJLFVBQVUsTUFBVixDQURxRDtBQUV6RCxJQUFFLE9BQUYsQ0FBVSxPQUFWLEVBQW1CO1dBQVcsd0JBQXdCLE9BQXhCLEVBQWlDLE9BQWpDO0dBQVgsQ0FBbkIsQ0FGeUQ7Q0FBM0Q7O0FBS0EsU0FBUyx1QkFBVCxDQUFpQyxPQUFqQyxFQUEwQyxPQUExQyxFQUFtRDtBQUNqRCxNQUFHLFlBQVksT0FBWixFQUFxQixPQUF4Qjs7QUFFQSxNQUFJLFlBQVksUUFBUSxDQUFSLEdBQVksUUFBUSxDQUFSLENBSHFCO0FBSWpELE1BQUksWUFBWSxRQUFRLENBQVIsR0FBWSxRQUFRLENBQVIsQ0FKcUI7QUFLakQsTUFBSSxXQUFXLEtBQUssSUFBTCxDQUFVLEtBQUssR0FBTCxDQUFTLFNBQVQsRUFBb0IsQ0FBcEIsSUFBeUIsS0FBSyxHQUFMLENBQVMsU0FBVCxFQUFvQixDQUFwQixDQUF6QixDQUFyQixDQUw2Qzs7QUFPakQsTUFBRyxXQUFXLFFBQVEsSUFBUixHQUFlLFFBQVEsSUFBUixFQUFjO0FBQ3pDLFdBRHlDO0dBQTNDOztBQUlBLE1BQUksWUFBWTtBQUNkLE9BQUcsWUFBWSxRQUFaO0FBQ0gsT0FBRyxZQUFZLFFBQVo7R0FGRCxDQVg2QztBQWVqRCxNQUFJLGVBQWdCLG1CQUFtQixRQUFRLElBQVIsR0FBZSxRQUFRLElBQVIsQ0FBbEMsR0FBa0QsS0FBSyxHQUFMLENBQVMsUUFBVCxFQUFtQixDQUFuQixDQUFsRCxDQWY2QjtBQWdCakQsTUFBSSxRQUFRLGVBQWUsVUFBVSxDQUFWLEdBQWMsUUFBUSxJQUFSLENBaEJRO0FBaUJqRCxNQUFJLFFBQVEsZUFBZSxVQUFVLENBQVYsR0FBYyxRQUFRLElBQVIsQ0FqQlE7QUFrQmpELFVBQVEsTUFBUixJQUFrQixLQUFsQixDQWxCaUQ7QUFtQmpELFVBQVEsTUFBUixJQUFrQixLQUFsQixDQW5CaUQ7Q0FBbkQ7Ozs7O0FDYkEsSUFBTSxJQUFJLFFBQVEsUUFBUixDQUFKO0lBQ0Esa0JBQWtCLFFBQVEsNkJBQVIsQ0FBbEI7O0FBRU4sT0FBTyxPQUFQLEdBQWlCLFNBQVMsOEJBQVQsQ0FBd0MsT0FBeEMsRUFBaUQsVUFBakQsRUFBNkQ7QUFDNUUsSUFBRSxPQUFGLENBQVUsT0FBVixFQUFtQjtXQUFLLDhCQUE4QixDQUE5QixFQUFpQyxVQUFqQztHQUFMLENBQW5CLENBRDRFO0NBQTdEOztBQUlqQixTQUFTLDZCQUFULENBQXVDLE1BQXZDLEVBQStDLFVBQS9DLEVBQTJEO0FBQ3pELE1BQUksU0FBUyxDQUFDLE9BQU8sTUFBUCxHQUFnQixPQUFPLFVBQVAsQ0FBakIsR0FBc0MsQ0FBdEMsQ0FENEM7QUFFekQsTUFBSSxTQUFTLENBQUMsT0FBTyxNQUFQLEdBQWdCLE9BQU8sVUFBUCxDQUFqQixHQUFzQyxDQUF0QyxDQUY0QztBQUd6RCxTQUFPLENBQVAsR0FBVyxPQUFPLENBQVAsR0FBVyxTQUFTLFVBQVQsQ0FIbUM7QUFJekQsU0FBTyxDQUFQLEdBQVcsT0FBTyxDQUFQLEdBQVcsU0FBUyxVQUFULENBSm1DOztBQU16RCw4QkFBNEIsTUFBNUIsRUFOeUQ7Q0FBM0Q7O0FBU0EsU0FBUywyQkFBVCxDQUFxQyxNQUFyQyxFQUE2QztBQUMzQyxNQUFHLE9BQU8sQ0FBUCxHQUFXLGdCQUFnQixLQUFoQixHQUF3QixFQUF4QixFQUE0QixPQUFPLENBQVAsR0FBVyxDQUFDLEVBQUQsQ0FBckQ7QUFDQSxNQUFHLE9BQU8sQ0FBUCxHQUFXLENBQUMsRUFBRCxFQUFLLE9BQU8sQ0FBUCxHQUFXLGdCQUFnQixLQUFoQixHQUF3QixFQUF4QixDQUE5Qjs7QUFFQSxNQUFHLE9BQU8sQ0FBUCxHQUFXLGdCQUFnQixNQUFoQixHQUF5QixFQUF6QixFQUE2QixPQUFPLENBQVAsR0FBVyxDQUFDLEVBQUQsQ0FBdEQ7QUFDQSxNQUFHLE9BQU8sQ0FBUCxHQUFXLENBQUMsRUFBRCxFQUFLLE9BQU8sQ0FBUCxHQUFXLGdCQUFnQixNQUFoQixHQUF5QixFQUF6QixDQUE5QjtDQUxGOzs7OztBQ2hCQSxJQUFNLGtCQUFrQixRQUFRLDZCQUFSLENBQWxCOztBQUVOLE9BQU8sT0FBUCxHQUFpQjtBQUNmLE1BQUksT0FBSixHQUFjO0FBQUUsV0FBTyxPQUFQLENBQUY7R0FBZDtBQUNBLGNBRmU7QUFHZixZQUhlO0FBSWYsOEJBSmU7Q0FBakI7O0FBT0EsSUFBTSxTQUFTLFNBQVMsYUFBVCxDQUF1QixRQUF2QixDQUFUO0lBQ0EsVUFBVSxPQUFPLFVBQVAsQ0FBa0IsSUFBbEIsQ0FBVjs7QUFFTixnQkFBZ0IsV0FBaEIsQ0FBNEIsc0JBQTVCOztBQUVBLFNBQVMsS0FBVCxHQUFpQjtBQUNmLFVBQVEsU0FBUixDQUFrQixDQUFsQixFQUFxQixDQUFyQixFQUF3QixPQUFPLEtBQVAsRUFBYyxPQUFPLE1BQVAsQ0FBdEMsQ0FEZTtDQUFqQjs7QUFJQSxTQUFTLElBQVQsQ0FBYyxVQUFkLEVBQTBCO0FBQ3hCLDJCQUR3QjtBQUV4QixhQUFXLFdBQVgsQ0FBdUIsTUFBdkIsRUFGd0I7Q0FBMUI7O0FBS0EsU0FBUyxhQUFULENBQXVCLE9BQXZCLEVBQWdDO0FBQzlCLElBQUUsT0FBRixDQUFVLE9BQVYsRUFBbUIsWUFBbkIsRUFEOEI7Q0FBaEM7O0FBSUEsU0FBUyxZQUFULENBQXNCLE1BQXRCLEVBQThCO0FBQzVCLFVBQVEsU0FBUixHQUQ0QjtBQUU1QixVQUFRLEdBQVIsQ0FBWSxPQUFPLENBQVAsRUFBVSxPQUFPLENBQVAsRUFBVSxPQUFPLElBQVAsRUFBYSxDQUE3QyxFQUFnRCxJQUFFLEtBQUssRUFBTCxDQUFsRCxDQUY0QjtBQUc1QixVQUFRLFNBQVIsR0FBb0IsT0FBTyxLQUFQLENBSFE7QUFJNUIsVUFBUSxJQUFSLEdBSjRCO0NBQTlCOztBQU9BLFNBQVMsc0JBQVQsR0FBa0M7QUFDaEMsU0FBTyxLQUFQLEdBQWUsZ0JBQWdCLEtBQWhCLENBRGlCO0FBRWhDLFNBQU8sTUFBUCxHQUFnQixnQkFBZ0IsTUFBaEIsQ0FGZ0I7Q0FBbEM7Ozs7O0FDbENBLElBQU0sSUFBSSxRQUFRLFFBQVIsQ0FBSjtJQUNBLFlBQVksUUFBUSx1QkFBUixDQUFaO0lBQ0Esb0JBQW9CLFFBQVEscUJBQVIsQ0FBcEI7SUFDQSxtQkFBbUIsUUFBUSxvQkFBUixDQUFuQjtJQUNBLHVCQUF1QixRQUFRLHdCQUFSLENBQXZCO0lBQ0EsU0FBUyxRQUFRLFVBQVIsQ0FBVDtJQUNBLGNBQWMsUUFBUSxlQUFSLENBQWQ7SUFDQSxrQkFBa0IsUUFBUSw2QkFBUixDQUFsQjs7QUFFTixJQUFNLGtCQUFrQixTQUFTLGNBQVQsQ0FBd0Isa0JBQXhCLENBQWxCO0lBQ0EscUJBQXFCLFNBQVMsY0FBVCxDQUF3QixtQkFBeEIsQ0FBckI7SUFDQSxvQkFBb0IsU0FBUyxjQUFULENBQXdCLGtCQUF4QixDQUFwQjtJQUNBLG1CQUFtQixTQUFTLGNBQVQsQ0FBd0Isb0JBQXhCLENBQW5CO0lBQ0EsY0FBYyxTQUFTLGNBQVQsQ0FBd0IsY0FBeEIsQ0FBZDs7QUFFTixJQUFJLFVBQVUsRUFBVjtBQUNKLElBQUksdUJBQUo7SUFBaUIsdUJBQWpCO0lBQThCLHlCQUE5QjtJQUE2Qyx3QkFBN0M7O0FBRUEsZ0JBQWdCLGdCQUFoQixDQUFpQyxRQUFqQyxFQUEyQyxjQUEzQztBQUNBLG1CQUFtQixnQkFBbkIsQ0FBb0MsU0FBcEMsRUFBK0MsYUFBSztBQUNsRCxNQUFHLG1CQUFtQixLQUFuQixLQUE2QixFQUE3QixFQUFpQyxPQUFwQztBQUNBLE1BQUcsRUFBRSxPQUFGLEtBQWMsRUFBZCxFQUFrQixpQkFBaUIsR0FBakIsQ0FBckI7QUFDQSxNQUFHLEVBQUUsT0FBRixLQUFjLEVBQWQsRUFBa0IsaUJBQWlCLEdBQWpCLENBQXJCO0FBQ0EsTUFBRyxFQUFFLE9BQUYsS0FBYyxFQUFkLElBQW9CLEVBQUUsT0FBRixLQUFjLEVBQWQsRUFBa0I7QUFDdkMsdUJBQW1CLEtBQW5CLEdBQTJCLFdBQVcsYUFBWCxDQUEzQixDQUR1QztBQUV2QyxNQUFFLGNBQUYsR0FGdUM7R0FBekM7QUFJQSxtQkFSa0Q7Q0FBTCxDQUEvQztBQVVBLGtCQUFrQixnQkFBbEIsQ0FBbUMsU0FBbkMsRUFBOEMsYUFBSztBQUNqRCxNQUFHLGtCQUFrQixLQUFsQixLQUE0QixFQUE1QixFQUFnQyxPQUFuQztBQUNBLE1BQUcsRUFBRSxPQUFGLEtBQWMsRUFBZCxFQUFrQixnQkFBZ0IsR0FBaEIsQ0FBckI7QUFDQSxNQUFHLEVBQUUsT0FBRixLQUFjLEVBQWQsRUFBa0IsZ0JBQWdCLEdBQWhCLENBQXJCO0FBQ0EsTUFBRyxFQUFFLE9BQUYsS0FBYyxFQUFkLElBQW9CLEVBQUUsT0FBRixLQUFjLEVBQWQsRUFBa0I7QUFDdkMsc0JBQWtCLEtBQWxCLEdBQTBCLFdBQVcsWUFBWCxDQUExQixDQUR1QztBQUV2QyxNQUFFLGNBQUYsR0FGdUM7R0FBekM7QUFJQSxtQkFSaUQ7Q0FBTCxDQUE5QztBQVVBLGlCQUFpQixnQkFBakIsQ0FBa0MsU0FBbEMsRUFBNkMsYUFBSztBQUNoRCxNQUFHLGlCQUFpQixLQUFqQixLQUEyQixFQUEzQixFQUErQixPQUFsQztBQUNBLE1BQUcsRUFBRSxPQUFGLEtBQWMsRUFBZCxFQUFrQixlQUFlLENBQWYsQ0FBckI7QUFDQSxNQUFHLEVBQUUsT0FBRixLQUFjLEVBQWQsRUFBa0IsZUFBZSxDQUFmLENBQXJCO0FBQ0EsTUFBRyxFQUFFLE9BQUYsS0FBYyxFQUFkLElBQW9CLEVBQUUsT0FBRixLQUFjLEVBQWQsRUFBa0I7QUFDdkMscUJBQWlCLEtBQWpCLEdBQXlCLFdBQVcsV0FBWCxDQUF6QixDQUR1QztBQUV2QyxNQUFFLGNBQUYsR0FGdUM7R0FBekM7QUFJQSxrQkFSZ0Q7Q0FBTCxDQUE3QztBQVVBLFlBQVksZ0JBQVosQ0FBNkIsT0FBN0IsRUFBc0MsYUFBdEM7O0FBRUEsT0FBTyxJQUFQLENBQVksU0FBUyxJQUFULENBQVo7QUFDQSxVQUFVLFdBQVYsQ0FBc0IsTUFBdEI7QUFDQTs7QUFFQSxTQUFTLE1BQVQsQ0FBZ0IsVUFBaEIsRUFBNEI7QUFDMUIsbUJBQWlCLE9BQWpCLEVBQTBCLFlBQTFCLEVBRDBCO0FBRTFCLG9CQUFrQixPQUFsQixFQUEyQixhQUEzQixFQUYwQjtBQUcxQix1QkFBcUIsT0FBckIsRUFBOEIsVUFBOUIsRUFIMEI7QUFJMUIsU0FBTyxLQUFQLEdBSjBCO0FBSzFCLFNBQU8sYUFBUCxDQUFxQixPQUFyQixFQUwwQjtDQUE1Qjs7QUFRQSxTQUFTLGNBQVQsR0FBMEI7QUFDeEIsb0JBRHdCO0FBRXhCLG1CQUZ3QjtBQUd4QixrQkFId0I7Q0FBMUI7O0FBTUEsU0FBUyxhQUFULEdBQXlCO0FBQ3ZCLGdCQUR1QjtBQUV2QixtQkFGdUI7Q0FBekI7O0FBS0EsU0FBUyxXQUFULEdBQXVCO0FBQ3JCLGdCQUFjLFdBQVcsaUJBQWlCLEtBQWpCLENBQXpCLENBRHFCO0FBRXJCLFlBQVUsRUFBVixDQUZxQjtBQUdyQixPQUFJLElBQUksSUFBSSxDQUFKLEVBQU8sSUFBSSxXQUFKLEVBQWlCLEdBQWhDLEVBQXFDO0FBQ25DLFlBQVEsSUFBUixDQUFhLFlBQVksZ0JBQWdCLEtBQWhCLEVBQXVCLGdCQUFnQixNQUFoQixDQUFoRCxFQURtQztHQUFyQztDQUhGOztBQVFBLFNBQVMsZUFBVCxHQUEyQjtBQUN6QixNQUFJLFlBQVksZ0JBQWdCLE9BQWhCLENBRFM7QUFFekIsTUFBRyxTQUFILEVBQWMsVUFBVSxLQUFWLEdBQWQsS0FDSyxVQUFVLElBQVYsR0FETDtDQUZGOztBQU1BLFNBQVMsY0FBVCxHQUEwQjtBQUN4QixrQkFBZ0IsV0FBVyxtQkFBbUIsS0FBbkIsQ0FBM0IsQ0FEd0I7Q0FBMUI7O0FBSUEsU0FBUyxhQUFULEdBQXlCO0FBQ3ZCLGlCQUFlLFdBQVcsa0JBQWtCLEtBQWxCLENBQTFCLENBRHVCO0NBQXpCOzs7OztBQzVGQSxJQUFNLElBQUksUUFBUSxRQUFSLENBQUo7O0FBRU4sT0FBTyxPQUFQLEdBQWlCO0FBQ2YsTUFBSSxNQUFKLEdBQWE7QUFBRSxXQUFPLE1BQVAsQ0FBRjtHQUFiO0FBQ0EsTUFBSSxLQUFKLEdBQVk7QUFBRSxXQUFPLEtBQVAsQ0FBRjtHQUFaO0FBQ0EsMEJBSGU7QUFJZixnQ0FKZTtDQUFqQjs7QUFPQSxJQUFNLFlBQVksRUFBWjs7QUFFTixJQUFJLGtCQUFKO0lBQVksaUJBQVo7QUFDQTtBQUNBOztBQUVBLFNBQVMsYUFBVCxHQUF5QjtBQUN2QixTQUFPLGdCQUFQLENBQXdCLFFBQXhCLEVBQWtDLEVBQUUsUUFBRixDQUFXLFlBQVgsRUFBeUIsR0FBekIsQ0FBbEMsRUFEdUI7Q0FBekI7O0FBSUEsU0FBUyxXQUFULENBQXFCLEVBQXJCLEVBQXlCO0FBQ3ZCLFlBQVUsSUFBVixDQUFlLEVBQWYsRUFEdUI7QUFFdkIsU0FBTyxFQUFQLENBRnVCO0NBQXpCOztBQUtBLFNBQVMsY0FBVCxDQUF3QixFQUF4QixFQUE0QjtBQUMxQixJQUFFLE9BQUYsQ0FBVSxTQUFWLEVBQXFCLEVBQXJCLEVBRDBCO0NBQTVCOztBQUlBLFNBQVMsZUFBVCxHQUEyQjtBQUN6QixJQUFFLE9BQUYsQ0FBVSxTQUFWLEVBQXFCO1dBQUs7R0FBTCxDQUFyQixDQUR5QjtDQUEzQjs7QUFJQSxTQUFTLFlBQVQsQ0FBc0IsQ0FBdEIsRUFBeUI7QUFDdkIscUJBRHVCO0FBRXZCLG9CQUZ1QjtDQUF6Qjs7QUFLQSxTQUFTLGdCQUFULEdBQTRCO0FBQzFCLFdBQVMsT0FBTyxXQUFQLENBRGlCO0FBRTFCLFVBQVEsT0FBTyxVQUFQLENBRmtCO0NBQTVCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImNvbnN0IF8gPSByZXF1aXJlKCdsb2Rhc2gnKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIGFkZE9ic2VydmVyLFxyXG4gIHJlbW92ZU9ic2VydmVyLFxyXG4gIHN0YXJ0LFxyXG4gIHN0b3AsXHJcbiAgdG9nZ2xlXHJcbn07XHJcblxyXG5jb25zdCBvYnNlcnZlcnMgPSBbXTtcclxuY29uc3QgYW5pbWF0ZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XHJcblxyXG5sZXQgaXNSdW5uaW5nID0gZmFsc2U7XHJcbmxldCBwcmV2aW91cztcclxuXHJcbmZ1bmN0aW9uIGFkZE9ic2VydmVyKGZuKSB7XHJcbiAgb2JzZXJ2ZXJzLnB1c2goZm4pO1xyXG4gIHJldHVybiBmbjtcclxufVxyXG5cclxuZnVuY3Rpb24gbm90aWZ5T2JzZXJ2ZXJzKGR1cmF0aW9uKSB7XHJcbiAgXy5mb3JFYWNoKG9ic2VydmVycywgbyA9PiBvKGR1cmF0aW9uKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZU9ic2VydmVyKGZuKSB7XHJcbiAgXy53aXRob3V0KG9ic2VydmVycywgZm4pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdGFydCgpIHtcclxuICBpZihpc1J1bm5pbmcpIHJldHVybjtcclxuICBpc1J1bm5pbmcgPSB0cnVlO1xyXG4gIHByZXZpb3VzID0gbnVsbDtcclxuICBhbmltYXRlKHRpY2spO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wKCkge1xyXG4gIGlzUnVubmluZyA9IGZhbHNlO1xyXG4gIHByZXZpb3VzID0gbnVsbDtcclxufVxyXG5cclxuZnVuY3Rpb24gdGljayhlbmQpIHtcclxuICBpZihwcmV2aW91cyA9PT0gbnVsbCkge1xyXG4gICAgcHJldmlvdXMgPSBlbmQ7XHJcbiAgfVxyXG4gIGxldCBkdXJhdGlvbiA9IChlbmQgLSBwcmV2aW91cykgLyAoMTAwMCAvIDYwKTtcclxuICBwcmV2aW91cyA9IGVuZDtcclxuICBub3RpZnlPYnNlcnZlcnMoZHVyYXRpb24pO1xyXG4gIGlmKGlzUnVubmluZykgYW5pbWF0ZSh0aWNrKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9nZ2xlKCkge1xyXG4gIGlmKGlzUnVubmluZykgc3RvcCgpO1xyXG4gIGVsc2Ugc3RhcnQoKTtcclxufVxyXG4iLCJjb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyksXHJcbiAgICAgIHJhbmRvbWNvbG9yID0gcmVxdWlyZSgncmFuZG9tY29sb3InKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYnVpbGRQbGFuZXQod2lkdGgsIGhlaWdodCkge1xyXG5cclxuICBsZXQgY29sb3IgPSByYW5kb21jb2xvcigpO1xyXG4gIGxldCBzaXplID0gXy5yYW5kb20oNSwgMjAsIHRydWUpO1xyXG4gIGxldCBzcGVlZFggPSBfLnJhbmRvbSgtNSwgNSk7XHJcbiAgbGV0IHNwZWVkWSA9IF8ucmFuZG9tKC01LCA1KTtcclxuICBsZXQgcHJldlNwZWVkWCA9IHNwZWVkWDtcclxuICBsZXQgcHJldlNwZWVkWSA9IHNwZWVkWTtcclxuXHJcbiAgbGV0IG5ld1BsYW5ldCA9IHtcclxuICAgIGdldCBjb2xvcigpIHsgcmV0dXJuIGNvbG9yOyB9LFxyXG4gICAgZ2V0IG1hc3MoKSB7IHJldHVybiBzaXplICogc2l6ZSAqIHNpemU7IH0sXHJcbiAgICBnZXQgcHJldlNwZWVkWCgpIHsgcmV0dXJuIHByZXZTcGVlZFg7IH0sXHJcbiAgICBnZXQgcHJldlNwZWVkWSgpIHsgcmV0dXJuIHByZXZTcGVlZFk7IH0sXHJcbiAgICBnZXQgc2l6ZSgpIHsgcmV0dXJuIHNpemU7IH0sXHJcbiAgICBnZXQgc3BlZWRYKCkgeyByZXR1cm4gc3BlZWRYOyB9LFxyXG4gICAgc2V0IHNwZWVkWChuZXdTcGVlZCkge1xyXG4gICAgICBwcmV2U3BlZWRYID0gc3BlZWRYO1xyXG4gICAgICBzcGVlZFggPSBuZXdTcGVlZDtcclxuICAgIH0sXHJcbiAgICBnZXQgc3BlZWRZKCkgeyByZXR1cm4gc3BlZWRZOyB9LFxyXG4gICAgc2V0IHNwZWVkWShuZXdTcGVlZCkge1xyXG4gICAgICBwcmV2U3BlZWRZID0gc3BlZWRZO1xyXG4gICAgICBzcGVlZFkgPSBuZXdTcGVlZDtcclxuICAgIH0sXHJcblxyXG4gICAgeDogXy5yYW5kb20od2lkdGgpLFxyXG4gICAgeTogXy5yYW5kb20oaGVpZ2h0KVxyXG4gIH07XHJcblxyXG4gIHJldHVybiBuZXdQbGFuZXQ7XHJcbn07XHJcbiIsImNvbnN0IF8gPSByZXF1aXJlKCdsb2Rhc2gnKTtcclxuXHJcbmxldCBmcmljdGlvbkNvbnN0YW50O1xyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNhbGN1bGF0ZUZyaWN0aW9uT25DaWNyY2xlcyhjaXJjbGVzLCBfZnJpY3Rpb25Db25zdGFudF8pIHtcclxuICBmcmljdGlvbkNvbnN0YW50ID0gX2ZyaWN0aW9uQ29uc3RhbnRfO1xyXG4gIF8uZm9yRWFjaChjaXJjbGVzLCBjYWxjdWxhdGVGcmljdGlvbk9uQ2ljcmNsZSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVGcmljdGlvbk9uQ2ljcmNsZShjaXJjbGUpIHtcclxuICBsZXQgZnJpY3Rpb25YID0gZnJpY3Rpb25Db25zdGFudCAqIGNpcmNsZS5zcGVlZFg7XHJcbiAgbGV0IGZyaWN0aW9uWSA9IGZyaWN0aW9uQ29uc3RhbnQgKiBjaXJjbGUuc3BlZWRZO1xyXG4gIGxldCBhY2NYID0gZnJpY3Rpb25YIC8gY2lyY2xlLm1hc3M7XHJcbiAgbGV0IGFjY1kgPSBmcmljdGlvblkgLyBjaXJjbGUubWFzcztcclxuXHJcbiAgbGV0IG5ld1hTcGVlZCA9IGNpcmNsZS5zcGVlZFggLSBhY2NYO1xyXG4gIGNpcmNsZS5zcGVlZFggPSBuZXdYU3BlZWQ7XHJcblxyXG4gIGxldCBuZXdZU3BlZWQgPSBjaXJjbGUuc3BlZWRZIC0gYWNjWTtcclxuICBjaXJjbGUuc3BlZWRZID0gbmV3WVNwZWVkO1xyXG5cclxufVxyXG4iLCJjb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XHJcblxyXG5sZXQgZ3Jhdml0eUNvbnN0YW50O1xyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNhbGN1bGF0ZVNwZWVkRm9yR3Jhdml0eU9uQ2lyY2xlcyhjaXJjbGVzLCBfZ3Jhdml0eUNvbnN0YW50Xykge1xyXG4gIGdyYXZpdHlDb25zdGFudCA9IF9ncmF2aXR5Q29uc3RhbnRfO1xyXG4gIF8uZm9yRWFjaChjaXJjbGVzLCBjID0+IGNhbGN1bGF0ZVNwZWVkRm9yR3Jhdml0eU9uQ2lyY2xlKGMsIGNpcmNsZXMpKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZVNwZWVkRm9yR3Jhdml0eU9uQ2lyY2xlKGNpcmNsZSwgY2lyY2xlcykge1xyXG4gIGxldCBjaXJjbGVBID0gY2lyY2xlO1xyXG4gIF8uZm9yRWFjaChjaXJjbGVzLCBjaXJjbGVCID0+IGNhbGNHcmF2aXR5QmV0d2VlbkFBbmRCKGNpcmNsZUEsIGNpcmNsZUIpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY0dyYXZpdHlCZXR3ZWVuQUFuZEIoY2lyY2xlQSwgY2lyY2xlQikge1xyXG4gIGlmKGNpcmNsZUEgPT09IGNpcmNsZUIpIHJldHVybjtcclxuXHJcbiAgbGV0IHhEaXN0YW5jZSA9IGNpcmNsZUEueCAtIGNpcmNsZUIueDtcclxuICBsZXQgeURpc3RhbmNlID0gY2lyY2xlQS55IC0gY2lyY2xlQi55O1xyXG4gIGxldCBkaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLnBvdyh4RGlzdGFuY2UsIDIpICsgTWF0aC5wb3coeURpc3RhbmNlLCAyKSk7XHJcblxyXG4gIGlmKGRpc3RhbmNlIDwgY2lyY2xlQS5zaXplICsgY2lyY2xlQi5zaXplKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgZGlyZWN0aW9uID0ge1xyXG4gICAgeDogeERpc3RhbmNlIC8gZGlzdGFuY2UsXHJcbiAgICB5OiB5RGlzdGFuY2UgLyBkaXN0YW5jZVxyXG4gIH07XHJcbiAgbGV0IGdyYXZpdHlGb3JjZSAgPSBncmF2aXR5Q29uc3RhbnQgKiAoY2lyY2xlQS5tYXNzICogY2lyY2xlQi5tYXNzKSAvIE1hdGgucG93KGRpc3RhbmNlLCAyKTtcclxuICBsZXQgeEFjY0EgPSBncmF2aXR5Rm9yY2UgKiBkaXJlY3Rpb24ueCAvIGNpcmNsZUEubWFzcztcclxuICBsZXQgeUFjY0EgPSBncmF2aXR5Rm9yY2UgKiBkaXJlY3Rpb24ueSAvIGNpcmNsZUIubWFzcztcclxuICBjaXJjbGVBLnNwZWVkWCAtPSB4QWNjQTtcclxuICBjaXJjbGVBLnNwZWVkWSAtPSB5QWNjQTtcclxufVxyXG4iLCJjb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyksXHJcbiAgICAgIHdpbmRvd0RpbWVuc2lvbiA9IHJlcXVpcmUoJy4vd2luZG93RGltZW5zaW9uT2JzZXJ2YWJsZScpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjYWxjdWxhdGVOZXdQb3NpdGlvbkZvckNpcmNsZXMoY2lyY2xlcywgZnJhbWVEZWx0YSkge1xyXG4gIF8uZm9yRWFjaChjaXJjbGVzLCBjID0+IGNhbGN1bGF0ZU5ld1Bvc2l0aW9uRm9yQ2lyY2xlKGMsIGZyYW1lRGVsdGEpKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZU5ld1Bvc2l0aW9uRm9yQ2lyY2xlKGNpcmNsZSwgZnJhbWVEZWx0YSkge1xyXG4gIGxldCBkZWx0YVggPSAoY2lyY2xlLnNwZWVkWCArIGNpcmNsZS5wcmV2U3BlZWRYKSAvIDI7XHJcbiAgbGV0IGRlbHRhWSA9IChjaXJjbGUuc3BlZWRZICsgY2lyY2xlLnByZXZTcGVlZFkpIC8gMjtcclxuICBjaXJjbGUueCA9IGNpcmNsZS54ICsgZGVsdGFYICogZnJhbWVEZWx0YTtcclxuICBjaXJjbGUueSA9IGNpcmNsZS55ICsgZGVsdGFZICogZnJhbWVEZWx0YTtcclxuXHJcbiAgcmVwb3NpdGlvbklmT3V0c2lkZU9mQ2FudmFzKGNpcmNsZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlcG9zaXRpb25JZk91dHNpZGVPZkNhbnZhcyhjaXJjbGUpIHtcclxuICBpZihjaXJjbGUueCA+IHdpbmRvd0RpbWVuc2lvbi53aWR0aCArIDQ1KSBjaXJjbGUueCA9IC00MDtcclxuICBpZihjaXJjbGUueCA8IC00NSkgY2lyY2xlLnggPSB3aW5kb3dEaW1lbnNpb24ud2lkdGggKyA0MDtcclxuXHJcbiAgaWYoY2lyY2xlLnkgPiB3aW5kb3dEaW1lbnNpb24uaGVpZ2h0ICsgNDUpIGNpcmNsZS55ID0gLTQwO1xyXG4gIGlmKGNpcmNsZS55IDwgLTQ1KSBjaXJjbGUueSA9IHdpbmRvd0RpbWVuc2lvbi5oZWlnaHQgKyA0MDtcclxufVxyXG4iLCJjb25zdCB3aW5kb3dEaW1lbnNpb24gPSByZXF1aXJlKCcuL3dpbmRvd0RpbWVuc2lvbk9ic2VydmFibGUnKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIGdldCBjb250ZXh0KCkgeyByZXR1cm4gY29udGV4dDsgfSxcclxuICBjbGVhcixcclxuICBpbml0LFxyXG4gIHJlbmRlckNpcmNsZXNcclxufTtcclxuXHJcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpLFxyXG4gICAgICBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcbndpbmRvd0RpbWVuc2lvbi5hZGRPYnNlcnZlcih1cGRhdGVDYW52YXNEaW1lbnNpb25zKTtcclxuXHJcbmZ1bmN0aW9uIGNsZWFyKCkge1xyXG4gIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXQocGFyZW50Tm9kZSkge1xyXG4gIHVwZGF0ZUNhbnZhc0RpbWVuc2lvbnMoKTtcclxuICBwYXJlbnROb2RlLmFwcGVuZENoaWxkKGNhbnZhcyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNpcmNsZXMoY2lyY2xlcykge1xyXG4gIF8uZm9yRWFjaChjaXJjbGVzLCByZW5kZXJDaXJjbGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDaXJjbGUoY2lyY2xlKSB7XHJcbiAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICBjb250ZXh0LmFyYyhjaXJjbGUueCwgY2lyY2xlLnksIGNpcmNsZS5zaXplLCAwLCAyKk1hdGguUEkpO1xyXG4gIGNvbnRleHQuZmlsbFN0eWxlID0gY2lyY2xlLmNvbG9yO1xyXG4gIGNvbnRleHQuZmlsbCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVDYW52YXNEaW1lbnNpb25zKCkge1xyXG4gIGNhbnZhcy53aWR0aCA9IHdpbmRvd0RpbWVuc2lvbi53aWR0aDtcclxuICBjYW52YXMuaGVpZ2h0ID0gd2luZG93RGltZW5zaW9uLmhlaWdodDtcclxufVxyXG4iLCJjb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyksXHJcbiAgICAgIGFuaW1hdGlvbiA9IHJlcXVpcmUoJy4vYW5pbWF0aW9uT2JzZXJ2YWJsZScpLFxyXG4gICAgICBjYWxjdWxhdGVGcmljdGlvbiA9IHJlcXVpcmUoJy4vY2FsY3VsYXRlRnJpY3Rpb24nKSxcclxuICAgICAgY2FsY3VsYXRlR3Jhdml0eSA9IHJlcXVpcmUoJy4vY2FsY3VsYXRlR3Jhdml0eScpLFxyXG4gICAgICBjYWxjdWxhdGVOZXdQb3NpdGlvbiA9IHJlcXVpcmUoJy4vY2FsY3VsYXRlTmV3UG9zaXRpb24nKSxcclxuICAgICAgY2FudmFzID0gcmVxdWlyZSgnLi9jYW52YXMnKSxcclxuICAgICAgYnVpbGRQbGFuZXQgPSByZXF1aXJlKCcuL2J1aWxkUGxhbmV0JyksXHJcbiAgICAgIHdpbmRvd0RpbWVuc2lvbiA9IHJlcXVpcmUoJy4vd2luZG93RGltZW5zaW9uT2JzZXJ2YWJsZScpO1xyXG5cclxuY29uc3QgYW5pbWF0ZUNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuaW1hdGUtY2hlY2tib3gnKSxcclxuICAgICAgZnJpY3Rpb25Db25zdElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZyaWN0aW9uLWNvbnN0YW50JyksXHJcbiAgICAgIGdyYXZpdHlDb25zdElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyYXZpdHktY29uc3RhbnQnKSxcclxuICAgICAgcGxhbmV0Q291bnRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGFuZXQtY291bnQtaW5wdXQnKSxcclxuICAgICAgcmVzZXRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzZXQtYnV0dG9uJyk7XHJcblxyXG5sZXQgcGxhbmV0cyA9IFtdO1xyXG5sZXQgcGxhbmV0Q291bnQsIGlzQW5pbWF0aW5nLCBmcmljdGlvbkNvbnN0LCBncmF2aXR5Q29uc3Q7XHJcblxyXG5hbmltYXRlQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdXBkYXRlU2V0dGluZ3MpO1xyXG5mcmljdGlvbkNvbnN0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4ge1xyXG4gIGlmKGZyaWN0aW9uQ29uc3RJbnB1dC52YWx1ZSA9PT0gJycpIHJldHVybjtcclxuICBpZihlLmtleUNvZGUgPT09IDM4KSBmcmljdGlvbkNvbnN0ICs9IDAuNTtcclxuICBpZihlLmtleUNvZGUgPT09IDQwKSBmcmljdGlvbkNvbnN0IC09IDAuNTtcclxuICBpZihlLmtleUNvZGUgPT09IDM4IHx8IGUua2V5Q29kZSA9PT0gNDApIHtcclxuICAgIGZyaWN0aW9uQ29uc3RJbnB1dC52YWx1ZSA9IHBhcnNlRmxvYXQoZnJpY3Rpb25Db25zdCk7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfVxyXG4gIHVwZGF0ZVNldHRpbmdzKCk7XHJcbn0pO1xyXG5ncmF2aXR5Q29uc3RJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PiB7XHJcbiAgaWYoZ3Jhdml0eUNvbnN0SW5wdXQudmFsdWUgPT09ICcnKSByZXR1cm47XHJcbiAgaWYoZS5rZXlDb2RlID09PSAzOCkgZ3Jhdml0eUNvbnN0ICs9IDAuNTtcclxuICBpZihlLmtleUNvZGUgPT09IDQwKSBncmF2aXR5Q29uc3QgLT0gMC41O1xyXG4gIGlmKGUua2V5Q29kZSA9PT0gMzggfHwgZS5rZXlDb2RlID09PSA0MCkge1xyXG4gICAgZ3Jhdml0eUNvbnN0SW5wdXQudmFsdWUgPSBwYXJzZUZsb2F0KGdyYXZpdHlDb25zdCk7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfVxyXG4gIHVwZGF0ZVNldHRpbmdzKCk7XHJcbn0pO1xyXG5wbGFuZXRDb3VudElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHtcclxuICBpZihwbGFuZXRDb3VudElucHV0LnZhbHVlID09PSAnJykgcmV0dXJuO1xyXG4gIGlmKGUua2V5Q29kZSA9PT0gMzgpIHBsYW5ldENvdW50ICs9IDE7XHJcbiAgaWYoZS5rZXlDb2RlID09PSA0MCkgcGxhbmV0Q291bnQgLT0gMTtcclxuICBpZihlLmtleUNvZGUgPT09IDM4IHx8IGUua2V5Q29kZSA9PT0gNDApIHtcclxuICAgIHBsYW5ldENvdW50SW5wdXQudmFsdWUgPSBwYXJzZUZsb2F0KHBsYW5ldENvdW50KTtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9XHJcbiAgcmVzZXRTZXR0aW5ncygpO1xyXG59KTtcclxucmVzZXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXNldFNldHRpbmdzKTtcclxuXHJcbmNhbnZhcy5pbml0KGRvY3VtZW50LmJvZHkpO1xyXG5hbmltYXRpb24uYWRkT2JzZXJ2ZXIob25UaWNrKTtcclxucmVzZXRTZXR0aW5ncygpO1xyXG5cclxuZnVuY3Rpb24gb25UaWNrKGZyYW1lRGVsdGEpIHtcclxuICBjYWxjdWxhdGVHcmF2aXR5KHBsYW5ldHMsIGdyYXZpdHlDb25zdCk7XHJcbiAgY2FsY3VsYXRlRnJpY3Rpb24ocGxhbmV0cywgZnJpY3Rpb25Db25zdCk7XHJcbiAgY2FsY3VsYXRlTmV3UG9zaXRpb24ocGxhbmV0cywgZnJhbWVEZWx0YSk7XHJcbiAgY2FudmFzLmNsZWFyKCk7XHJcbiAgY2FudmFzLnJlbmRlckNpcmNsZXMocGxhbmV0cyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVNldHRpbmdzKCkge1xyXG4gIHVwZGF0ZUFuaW1hdGlvbigpO1xyXG4gIHVwZGF0ZUZyaWN0aW9uKCk7XHJcbiAgdXBkYXRlR3Jhdml0eSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXNldFNldHRpbmdzKCkge1xyXG4gIHVwZGF0ZUNvdW50KCk7XHJcbiAgdXBkYXRlU2V0dGluZ3MoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlQ291bnQoKSB7XHJcbiAgcGxhbmV0Q291bnQgPSBwYXJzZUZsb2F0KHBsYW5ldENvdW50SW5wdXQudmFsdWUpO1xyXG4gIHBsYW5ldHMgPSBbXTtcclxuICBmb3IodmFyIGkgPSAwOyBpIDwgcGxhbmV0Q291bnQ7IGkrKykge1xyXG4gICAgcGxhbmV0cy5wdXNoKGJ1aWxkUGxhbmV0KHdpbmRvd0RpbWVuc2lvbi53aWR0aCwgd2luZG93RGltZW5zaW9uLmhlaWdodCkpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlQW5pbWF0aW9uKCkge1xyXG4gIGxldCBpc0NoZWNrZWQgPSBhbmltYXRlQ2hlY2tib3guY2hlY2tlZDtcclxuICBpZihpc0NoZWNrZWQpIGFuaW1hdGlvbi5zdGFydCgpO1xyXG4gIGVsc2UgYW5pbWF0aW9uLnN0b3AoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlRnJpY3Rpb24oKSB7XHJcbiAgZnJpY3Rpb25Db25zdCA9IHBhcnNlRmxvYXQoZnJpY3Rpb25Db25zdElucHV0LnZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlR3Jhdml0eSgpIHtcclxuICBncmF2aXR5Q29uc3QgPSBwYXJzZUZsb2F0KGdyYXZpdHlDb25zdElucHV0LnZhbHVlKTtcclxufVxyXG4iLCJjb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBnZXQgaGVpZ2h0KCkgeyByZXR1cm4gaGVpZ2h0OyB9LFxyXG4gIGdldCB3aWR0aCgpIHsgcmV0dXJuIHdpZHRoOyB9LFxyXG4gIGFkZE9ic2VydmVyLFxyXG4gIHJlbW92ZU9ic2VydmVyXHJcbn07XHJcblxyXG5jb25zdCBvYnNlcnZlcnMgPSBbXTtcclxuXHJcbmxldCBoZWlnaHQsIHdpZHRoO1xyXG51cGRhdGVEaW1lbnNpb25zKCk7XHJcbmF0dGFjaEhhbmRsZXIoKTtcclxuXHJcbmZ1bmN0aW9uIGF0dGFjaEhhbmRsZXIoKSB7XHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIF8uZGVib3VuY2UoaGFuZGxlUmVzaXplLCAyMDApKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkT2JzZXJ2ZXIoZm4pIHtcclxuICBvYnNlcnZlcnMucHVzaChmbik7XHJcbiAgcmV0dXJuIGZuO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVPYnNlcnZlcihmbikge1xyXG4gIF8ud2l0aG91dChvYnNlcnZlcnMsIGZuKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbm90aWZ5T2JzZXJ2ZXJzKCkge1xyXG4gIF8uZm9yRWFjaChvYnNlcnZlcnMsIG8gPT4gbygpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUmVzaXplKGUpIHtcclxuICB1cGRhdGVEaW1lbnNpb25zKCk7XHJcbiAgbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZURpbWVuc2lvbnMoKSB7XHJcbiAgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG4gIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcbn1cclxuIl19
